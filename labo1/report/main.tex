\documentclass[frenchb, paper=a4, fontsize=11pt]{scrartcl}

\input{lib.tex}
\usepackage[makeroom]{cancel}

%%% Custom sectioning (sectsty package)
\usepackage{sectsty}								% Custom sectioning (see below)
\allsectionsfont{\scshape}						% Change font of al section commands

%%% Custom headers/footers (fancyhdr package)
\usepackage{fancyhdr}
\pagestyle{fancyplain}
\fancyhead{}										% No page header
\fancyfoot[L]{\small Groupe 1}					% You may remove/edit this line 
\fancyfoot[C]{}									% Empty
\fancyfoot[R]{\thepage}							% Pagenumbering
\renewcommand{\headrulewidth}{0pt}				% Remove header underlines
\renewcommand{\footrulewidth}{0pt}				% Remove footer underlines
\setlength{\headheight}{13.6pt}
\newcommand*\eq[1]{\overline{#1}} 				% equilibre


%%% Equation and float numbering
\numberwithin{equation}{section}					% Equationnumbering: section.eq#
\numberwithin{figure}{section}					% Figurenumbering: section.fig#
\numberwithin{table}{section}						% Tablenumbering: section.tab#

%%% Maketitle metadata
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} 	% Horizontal rule

\title{
		%\vspace{-1in} 	
		\usefont{OT1}{bch}{b}{n}
		\normalfont \normalsize \textsc{Ecole polytechnique de Louvain} \\ [25pt]
		\horrule{0.5pt} \\[0.4cm]
		\large LINMA1510 - Automatique linéaire\\
		\huge Laboratoire 1 - Contrôle du niveau d'eau dans un réservoir \\
		\horrule{1.5pt} \\[0.5cm]
}
\author{
		\normalfont
		\textsc{Groupe 62}\\
      	Antoine Paris\hspace{0.6cm} Philippe Verbist \\	
       	\normalsize
        \today
}
\date{}

\begin{document}
\maketitle


\section{Modèle}

Le modèle repose sur les équations suivantes:
\begin{itemize}
\item équation de continuité:
\begin{equation}
\frac{dh_3}{dt} = \frac{1}{S_R}q_{P3} - \frac{1}{S_R}(q_{F30}+q_{S30})
\label{eq:contnuity}
\end{equation}
\item loi de Toricelli:
\begin{align}
q_{F30}& = S_{F30} \sqrt{2gh_3} \label{eq:toricelliF}\\
q_{S30} &= S_{S30} \sqrt{2gh_3} \label{eq:toricelliS}
\end{align}
\end{itemize}

\section{Expliquer les valeurs choisies pour $\eq{q}_{P3}$ et $\eq{h}_3$. Expliquer le calcul de la surface $S_{S30}$}

La valeur de $q_{P3}$ a été imposée lors de l'expérience à $u_0$. La hauteur $h_3$ correspond à la valeur d'équilibre lorsque la valve frontale $S_{F30}$ est fermée et la valve $S_{S30}$ ouverte. Leur valeur chiffrée vaut
\begin{align}
q_{P3} & = \SI{30}{[\milli\liter\per\second]}\\
h_3 & = \SI{9.84}{[cm]}.
\end{align}

Nous avons travaillé dans les mêmes conditions expérimentales pour calculer $S_{S30}$ ($q_{F30} = 0$ et $\frac{dh_3}{dt} = 0$). Ainsi, à l'équilibre, en reprenant les équations \ref{eq:contnuity} et \ref{eq:toricelliS}, nous avons
\begin{align}
&\cancel{\frac{dh_3}{dt}} = \frac{1}{S_R}\eq{q}_{P3} - \frac{1}{S_R}(\cancel{q_{F30}}+q_{S30})\\
\Leftrightarrow & \eq{q}_{P3} = S_{S30} \sqrt{2g\eq{h}_3} \\
\Leftrightarrow & S_{S30} = \frac{\eq{q}_{P3}}{ \sqrt{2g\eq{h}_3}} = \SI{0.2159}{cm^2}
\end{align}

\section{Détailler le calcul du modèle linéarisé et le calcul des fonctions de transfert $G(s)$ and $H(s)$}

\subsection{Calcul du modèle linéarisé}

Soit le système initial
\begin{align}
x &= h_3 \\
u &= q_{P3}\\
v &= S_{F30}\\
\end{align}
Régit par les équations
\begin{align}
\frac{dx}{dt} &= f(x,u,v) = \frac{1}{S_R}u - \frac{1}{S_R}(v\sqrt{2gx} + S_{S30}\sqrt{2gx})\\
y &= h(x,u,v) = x
\end{align}

Pour linéarisé ce système, nous procédons au changement de variables
\begin{align}
\chi &= x-\eq{x} = x - 9.84\\
\rho &= u-\eq{u} = u - 30\\
\nu &= v - \eq{v} = v\\
\phi &= y - h(\eq{x}) = y - 30\\
\end{align}


et nous tensons de réécrire le système sous la forme
\begin{equation}
\left\{ \begin{array}{ccc}
\frac{d\chi}{dt} &=& A\chi + B\rho \\
\phi &=& C\chi + D\rho
\end{array}
\right.
\end{equation}

avec 
\begin{align}
A& = \frac{\partial f(x,u,v)}{\partial x}\rvert_{(\eq{x},\eq{u},\eq{v})} = -\frac{1}{S_R}(v\frac{g}{\sqrt{2gx}} + S_{S30}\frac{g}{\sqrt{2gx}})\rvert_{(\eq{x},\eq{u},\eq{v})} \\
&= -\frac{1}{S_R	} S_{S30} \frac{g}{\sqrt{2g\eq{x}}} = \SI{-.0355}{[]}\\
B &=\left[ \begin{array}{l}
 \frac{\partial f}{\partial u}\rvert_{\eq{x}} \\
  \frac{\partial f}{\partial v} \rvert_{\eq{x}}\\
\end{array} \right] 
= \left[ \begin{array}{l}
 \frac{1}{S_R} = \SI{43}{[]}\\
  \frac{\sqrt{2g\eq{x}}}{S_R}= \SI{-3.23}{[]}\\
\end{array} \right] \\
C &= \frac{\partial h}{\partial x}\rvert_{\eq{x}} = \SI{1}{}\\
D&=\left[ \begin{array}{l}
 \frac{\partial h}{\partial u}\rvert_{\eq{x}} \\
  \frac{\partial h}{\partial v} \rvert_{\eq{x}}\\
\end{array} \right]  = \left[ \begin{array}{l}
0\\
0
\end{array} \right] \SI{}{[]}
\end{align}

\subsection{Calcul des fonctions de transfert}
\begin{align}
G(s) &= C(sI-A)^{-1}B_u + D = \frac{0.02326}{s+0.03545}\\
H(s) &= C(sI-A)^{-1}B_v + D = \frac{-3.231}{s+0.03545}\\
\end{align}

\section{Fonctions de transfert en boucle fermée}

Nous considérons maintenant un controlleur PI tel que représenté à la figure \ref{fig:closed_loop}.

\begin{figure}[!ht]
	\centering
	\includegraphics[width=\linewidth]{img/closed_loop.png}
	\caption{Diagramme de bloc du système controllé par un controlleur PI}
	\label{fig:closed_loop}
\end{figure}



En posant 
\begin{align}
G(s) &=  \frac{0.02326}{s+0.03545} = \frac{\alpha}{s+\beta}\\
H(s) &= \frac{-3.231}{s+0.03545} = \frac{\alpha'}{s+\beta'}
\end{align}

On trouve
\begin{align}
G_{CL}(s) & \triangleq \frac{y}{r}\rvert_{v=0}\\
y &= K_P G \left(e+\frac{eK_i}{s} \right)\\
& = K_P G\left(r-y+\frac{(r-y)K_i}{s} \right)\\
y(s+\beta) & = K_P \alpha \left( r(1+\frac{K_i}{s}) - y(1+\frac{K_i}{s})\right)\\
y(s+\beta + 1 + \frac{K_i}{s}) & = \alpha K_P  \ r \left(1+\frac{K_i}{s} \right) \\
y(s^2 +(\beta+1)s + K_i) & = \alpha K_P  \ r \left(s+K_i \right) \\
\frac{y}{r}&= \frac{\alpha K_P  (s+K_i )}{s^2 +(\beta+1)s + K_i} = G_{CL}(s)
\end{align}



De même,
\begin{align}
H_{CL}(s) & \triangleq \frac{y}{v}\rvert_{r=0}\\
y &= G\left[v+K_P (e+\frac{eK_i}{s})\right]\\
&= G\left[ v + K_P(-y-\frac{-yK_i}{s})\right] \\
y(s+\beta') &= \alpha' v - \alpha' K_P y (1+\frac{K_i}{s})\\
y(s^2 + (\alpha'K_P+\beta')s + \alpha' K_P K_i) &= \alpha'v s\\
\frac{y}{v} & = \frac{\alpha' s}{s^2 + (\alpha'K_P+\beta')s + \alpha' K_P K_i} = H_{CL}(s)
\end{align}

\section{Analyse des performances de différents controlleurs avec une perturbation}



\section{Calcul des paramètres $K_P,K_I$ pour satisfaire certaines spécifications}

Les spécifications sont:
\begin{itemize}
\item pas d'overshoot
\item un temps de réponse trois fois plus petit que le système naturel (non controllé)
\end{itemize}

Reprenons le dénominateur de la fonction de transfert $G_{CL}(s)$:
\begin{equation}
D(s) = s^2 +(\beta+1)s + K_i
\end{equation}
que nous pouvons reprocher de la forme canonique suivante pour un système du deuxième ordre
\begin{equation}
D_c(s) = s^2 + 2\zeta \omega_n + \omega_n^2.
\end{equation}
Par identification, on obtient
\begin{align}
\omega_n &= \sqrt{K_I}\\
\zeta &= \frac{\beta +1}{2\sqrt{K_I}}
\end{align}

Les spécifications nous imposent:
\begin{align}
\zeta &\ge 1\\
t_R & = \frac{4}{\omega_n(\zeta - \sqrt{\zeta^2-1})} = 
\end{align}


\section{Non-linéarités du système controllé}
La non-linéarité principale vient du fait que le système d'équations initiales n'est pas linéaire, et qu'il a dû être linéarisé autour de son point d'équilibre. Ainsi, lorsque l'on ne se trouve pas proche de ce point d'équilibre, les équations que nous avons ne sont pas correctes.














\end{document}